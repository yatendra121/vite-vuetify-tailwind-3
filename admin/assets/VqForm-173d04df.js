import{d as e,E as t,h as o,A as r,y as s,j as a,l as n,F as i}from"./vendor-fcdf8aba.js";import{A as l}from"./index-16f05835.js";import{u,b as p}from"./app-68c6f644.js";import{u as m}from"./form-4529533a.js";import"./useAuthUserRepository-6d0bca84.js";import"./index-a381323b.js";import"./index-8d523eaa.js";import"./preload-helper-125326fd.js";import"./ParentRouteView-0234de8a.js";import"./_plugin-vue_export-helper-1b428a4d.js";const d=(e,t,o)=>{const r=t||new FormData;let s;for(const a in e)e.hasOwnProperty(a)&&(s=o?o+"["+a+"]":a,e[a]instanceof Date?r.append(s,e[a].toISOString()):"object"!=typeof e[a]||e[a]instanceof File||e[a]instanceof Blob?e[a]instanceof Blob&&e[a]?r.append(s,e[a],e[a].name):e[a]&&r.append(s,e[a]):d(e[a],r,s));return r},c=e({components:{VForm:t,Form:t},props:{id:{type:String,required:!0},action:{type:String,required:!0},method:{type:String,default:()=>"POST"},initialValues:{type:Object,default:()=>{}},valuesSchema:{type:Object,default:()=>{}},formData:{type:Boolean,default:()=>!1}},emits:["submitedSuccess","submitedError","submitedError"],setup(e,{attrs:c,emit:y,slots:j}){const h=o((()=>f(e.initialValues,e.valuesSchema))),b=m();r((()=>{b.addForm(e.id)})),s((()=>b.removeForm(e.id)));return()=>a(i,null,[a(t,n({id:e.id,onSubmit:(t,o)=>((t,o)=>{const r=e.formData?d(t):t;b.changeBusy(e.id,!0),u(e.action,{method:e.method,data:r}).then((e=>{const t=new l(e);y("submitedSuccess",t)})).catch((async e=>{const{getErrorResponse:t}=p(),{eResponse:r}=await t(e),s=new l(r.value);o.setErrors(s.getErrors()),y("submitedError",s)})).finally((()=>{b.changeBusy(e.id,!1)}))})(t,o),"initial-values":h.value},c),{default:()=>{var e;return[a(i,null,[null==(e=j.default)?void 0:e.call(j)])]},...j})])}}),f=(e,t)=>e&&t?{...y(e,t),...e}:e,y=(e,t)=>{const o=[];for(const r in t)if(Object.hasOwnProperty.call(t,r)){const s=t[r].split(".");let a=e;for(const[e,t]of s.entries()){if("*"===t){let t=[],o=0;for(const r of a)t=[y(a[o++],{key:s.slice(e+1).join(".")}).key,...t];a=t;break}"string"==typeof t&&(a=null==a?void 0:a[t])}o[r]=a??t}return o};export{c as default};
